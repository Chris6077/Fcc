var data,geo;$(document).ready(function(){AOS.init({disable:"mobile"})}),$(document).ready(()=>{d3.json("https://raw.githubusercontent.com/no-stack-dub-sack/testable-projects-fcc/master/src/data/choropleth_map/for_user_education.json").then(t=>{data=t,d3.json("https://raw.githubusercontent.com/no-stack-dub-sack/testable-projects-fcc/master/src/data/choropleth_map/counties.json").then(t=>{geo=t,draw()})})});let draw=()=>{$(".tooltip").remove();let t=70,e=90,a=30,r=70,o=600,n=1e3,d=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],i=15,s=50,l=d3.scaleQuantize().domain([d3.min(data,t=>t.bachelorsOrHigher),d3.max(data,t=>t.bachelorsOrHigher)]).range(d),c=d3.select("body").append("div").style("opacity",0).attr("id","tooltip").attr("class","tooltip").attr("data-education",0),h=t=>{let e={};return data.forEach(a=>{a.fips===t&&(e={...a})}),e},g=d3.select("main").append("svg").attr("height",t+o+e).attr("width",r+n+a),p=g.append("g").attr("transform",`translate(${r},${t})`);p.selectAll("path").data(topojson.feature(geo,geo.objects.counties).features).enter().append("path").attr("d",d3.geoPath()).attr("class","county").attr("fill",t=>l(h(t.id).bachelorsOrHigher)).style("stroke","black").style("stroke-width","0.2").attr("data-fips",t=>h(t.id).fips).attr("data-education",t=>h(t.id).bachelorsOrHigher).on("mouseover",t=>{let e=t.id;c.html((t=>{let e=h(t);return`${e.area_name}, ${e.state}: ${e.bachelorsOrHigher}%`})(e)).attr("data-education",h(e).bachelorsOrHigher).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-20+"px"),c.transition().duration(100).style("opacity",.9)}).on("mouseout",()=>{c.transition().duration(300).style("opacity",0)}),p.append("path").datum(topojson.mesh(geo,geo.objects.states,(t,e)=>t!==e)).attr("class","states").attr("d",d3.geoPath());let u=g.append("g").attr("id","legend");u.selectAll("rect").data(d).enter().append("rect").attr("x",(t,e)=>e*s).attr("height",i).attr("width",s).attr("fill",t=>t).attr("stroke","black").style("stroke-width","0.2"),u.append("g").call(d3.axisBottom(d3.scaleLinear().domain(l.domain()).range([0,s*d.length])).tickFormat(d3.format(".1f")).tickValues(l.range().reduce((t,e,a)=>{let r=l.invertExtent(e);return t.push(r[0]),a===l.range().length-1&&t.push(r[1]),t},[])).tickFormat(t=>t.toFixed(1)+"%")).attr("id","lg-axis").attr("color","black").attr("transform",`translate(0,${i})`),u.attr("transform",`translate(${r+(n-u.node().getBoundingClientRect().width)/2},${t})`);let m=g.append("text").attr("id","title").text("United States Educational Attainment"),b=g.append("text").attr("id","description").html("Percentage of adults age 25 and older with a bachelor's degree or higher (2010-2014)");m.attr("x",r+n/2-m.node().getBoundingClientRect().width/2).attr("y",m.node().getBoundingClientRect().height/2+20),b.attr("x",r+n/2-b.node().getBoundingClientRect().width/2).attr("y",m.node().getBoundingClientRect().height+b.node().getBoundingClientRect().height+10)};